# Изменения версии 1.3

## Дата: 2024-11-14

## Внесённые изменения

### 1. Возврат к стандартной сетке 2x2

Убран специальный layout для Логики A:
- ✅ Удалены CSS классы `.layout-default` и `.layout-custom`
- ✅ Удалены grid-area стили
- ✅ Возвращена фиксированная сетка 2x2 для всех логик
- ✅ Упрощена функция `renderCharts()` - убрана обработка layout

### 2. Разделение на два отдельных файла

Теперь есть ДВА независимых дашборда:

#### **dashboard_mop.html** (Логика A - MOP)
- Только MOP графики
- Нормы: 150, 280, 350, 220
- Графики: MOP Приёмка, MOP Размещение, MOP Сборка, MOP Контроль
- Индикатор: "MOP Логика" (зелёный)

#### **dashboard_old.html** (Логика B - Старая)
- Только старые графики
- Нормы: 120, 250, 300
- Графики: Приёмка, Размещение, Сборка
- Индикатор: "Старая Логика" (оранжевый)

### 3. Упрощённая структура каждого файла

В каждом файле:
- ✅ Убрана логика автоопределения (selectLogic)
- ✅ Один объект NORMS (вместо LOGIC_A/LOGIC_B)
- ✅ Один массив CHARTS_CONFIG (вместо двух логик)
- ✅ Упрощена функция extractMetrics
- ✅ Убрана переменная currentLogic
- ✅ Упрощена updateLastUpdateTime

### 4. Файл dashboard.html

Остаётся универсальным с автоопределением логики:
- ✅ Содержит обе логики (A и B)
- ✅ Автоматически выбирает нужную
- ✅ Стандартная сетка 2x2

## Структура проекта

```
Dashboard/
├── dashboard.html          ← Универсальный (авто-выбор логики)
├── dashboard_mop.html      ← Только MOP (Логика A)
├── dashboard_old.html      ← Только старая (Логика B)
├── server.js               ← Сервер
└── start.bat               ← Запуск
```

## Как использовать

### Вариант 1: Универсальный (автоопределение)
```
http://localhost:3000/dashboard.html
```
Автоматически определит логику по данным

### Вариант 2: Только MOP
```
http://localhost:3000/dashboard_mop.html
```
Всегда использует MOP логику

### Вариант 3: Только старая логика
```
http://localhost:3000/dashboard_old.html
```
Всегда использует старую логику

## Изменение норм

### Для MOP дашборда (dashboard_mop.html)
```javascript
const NORMS = {
    receiving: 150,      // ⬅️ Измените здесь
    placement: 280,      // ⬅️ Измените здесь
    picking: 350,        // ⬅️ Измените здесь
    control: 220         // ⬅️ Измените здесь
};
```

### Для старого дашборда (dashboard_old.html)
```javascript
const NORMS = {
    receiving: 120,      // ⬅️ Измените здесь
    placement: 250,      // ⬅️ Измените здесь
    picking: 300         // ⬅️ Измените здесь
};
```

### Для универсального (dashboard.html)
```javascript
const NORMS = {
    LOGIC_A: {
        receiving: 150,
        placement: 280,
        picking: 350,
        control: 220
    },
    LOGIC_B: {
        receiving: 120,
        placement: 250,
        picking: 300
    }
};
```

## Расположение графиков

Все три файла теперь используют **стандартную сетку 2x2**:

```
┌──────────────┬──────────────┐
│  График 1    │  График 2    │
├──────────────┼──────────────┤
│  График 3    │  График 4    │
└──────────────┴──────────────┘
```

### MOP (dashboard_mop.html):
```
┌──────────────┬──────────────┐
│ MOP Приёмка  │MOP Размещение│
├──────────────┼──────────────┤
│  MOP Сборка  │ MOP Контроль │
└──────────────┴──────────────┘
```

### Старый (dashboard_old.html):
```
┌──────────────┬──────────────┐
│   Приёмка    │  Размещение  │
├──────────────┼──────────────┤
│    Сборка    │    (пусто)   │
└──────────────┴──────────────┘
```

## Преимущества разделения

✅ **Проще менять нормы** - каждый файл независим  
✅ **Быстрее загрузка** - меньше кода в каждом файле  
✅ **Надёжнее** - нет риска ошибочного переключения логики  
✅ **Понятнее** - явно видно какой дашборд открыт  
✅ **Удобнее** - можно открыть оба одновременно  

## Затронутые файлы

- `dashboard.html` - возврат к стандартной сетке, убраны специальные layouts
- `dashboard_mop.html` - NEW! Только MOP логика
- `dashboard_old.html` - NEW! Только старая логика

## Обратная совместимость

- ✅ dashboard.html работает как раньше (автоопределение)
- ✅ Все функции сохранены
- ✅ Автообновление каждые 60 секунд
- ✅ ТОП-3 сотрудников
- ✅ Цветовая индикация
- ✅ Линии норм

## Тестирование

- ✅ Все три файла работают независимо
- ✅ Нормы определены правильно
- ✅ Сетка 2x2 применена везде
- ✅ Функции упрощены
- ✅ Нет ошибок JavaScript

## Рекомендации

### Для складов с MOP
Используйте **dashboard_mop.html**

### Для старых складов
Используйте **dashboard_old.html**

### Для смешанных складов
Используйте **dashboard.html** (автоопределение)

---

**Версия:** 1.3  
**Статус:** ✅ Готово  
**Автор:** AI Assistant  
**Предыдущая версия:** 1.2  

## Миграция с версии 1.2

1. Если использовали dashboard.html с автоопределением:
   - Ничего менять не нужно
   - Продолжайте использовать dashboard.html

2. Если знаете свою логику:
   - MOP → используйте dashboard_mop.html
   - Старая → используйте dashboard_old.html

3. Изменение норм:
   - Теперь проще - в каждом файле свой NORMS
   - Не нужно различать LOGIC_A и LOGIC_B
