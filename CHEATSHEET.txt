╔════════════════════════════════════════════════════════════════════════════╗
║                      ШПАРГАЛКА ПО ДАШБОРДУ                                 ║
╚════════════════════════════════════════════════════════════════════════════╝

🚀 БЫСТРЫЙ СТАРТ

1. Скачать Node.js: https://nodejs.org/dist/latest/
   → Файл: node-v[версия]-win-x64.zip

2. Распаковать в папку: node/

3. Добавить Excel файл: *.xlsx

4. Запустить: start.bat

5. Открыть: http://localhost:3000

═══════════════════════════════════════════════════════════════════════════════

📁 СТРУКТУРА ПАПКИ

Dashboard/
├── node/node.exe          ← Портативный Node.js
├── dashboard.html         ← Дашборд
├── server.js              ← Сервер
├── start.bat              ← ЗАПУСК (двойной клик!)
└── ваш_файл.xlsx         ← Excel с данными

═══════════════════════════════════════════════════════════════════════════════

⚡ ГОРЯЧИЕ КЛАВИШИ

В браузере:
• F12           - Открыть консоль разработчика
• F5            - Обновить страницу
• Ctrl+F5       - Обновить с очисткой кеша

В консоли сервера:
• Ctrl+C        - Остановить сервер

═══════════════════════════════════════════════════════════════════════════════

🎯 ДВЕ ЛОГИКИ

┌─────────────────────────────────────────────────────────────────────────┐
│ Логика B (Старый дашборд)                                               │
├─────────────────────────────────────────────────────────────────────────┤
│ Когда: Есть операция "пикинг ЗХ МЕЗОНИН RMIXED"                        │
│                                                                          │
│ Графики:                                                                 │
│ • Приёмка        → приемка                                              │
│ • Размещение     → ручные перемещения, привязка к местам                │
│ • Сборка         → пикинг зх мезонин rmixed                             │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ Логика A (Новый дашборд / MOP)                                          │
├─────────────────────────────────────────────────────────────────────────┤
│ Когда: Во всех остальных случаях                                        │
│                                                                          │
│ Графики (только с данными):                                             │
│ • MOP Сборка     → пикинг mop зона хранения мезонин                     │
│ • MOP Приёмка    → приемка                                              │
│ • MOP Размещение → перемещения, привязка к местам, ручные перемещения   │
│ • MOP Контроль   → контроль                                             │
└─────────────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

🎨 ЦВЕТОВАЯ СХЕМА

┌─────────────────┬─────────────────────────────────────────────────────────┐
│ Достижение нормы│ Цвет столбца                                            │
├─────────────────┼─────────────────────────────────────────────────────────┤
│ 0-70%           │ 🔴 Красный                                              │
│ 70-100%         │ 🟡 Жёлтый                                               │
│ 100%+           │ 🟢 Зелёный                                              │
└─────────────────┴─────────────────────────────────────────────────────────┘

┌─────────────────┬─────────────────────────────────────────────────────────┐
│ ТОП-3 место     │ Цвет фона                                               │
├─────────────────┼─────────────────────────────────────────────────────────┤
│ 🥇 1 место      │ 🟡 Золото                                               │
│ 🥈 2 место      │ ⚪ Серебро                                              │
│ 🥉 3 место      │ 🟤 Бронза                                               │
└─────────────────┴─────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

⚙️ ОСНОВНЫЕ НАСТРОЙКИ

В файле dashboard.html:

┌────────────────────────┬──────────────────┬────────────────────────────┐
│ Параметр               │ По умолчанию     │ Что изменить               │
├────────────────────────┼──────────────────┼────────────────────────────┤
│ Интервал обновления    │ 60000 (60 сек)   │ REFRESH_INTERVAL_MS        │
│ Период данных          │ 30 дней          │ DATE_RANGE_DAYS            │
│ Количество в ТОП       │ 3                │ TOP_N                      │
│ Нормативы              │ 120/250/300      │ LOGIC_A/LOGIC_B → norm     │
│ Порт сервера (server.js)│ 3000            │ PORT                       │
└────────────────────────┴──────────────────┴────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

🔧 БЫСТРЫЕ РЕШЕНИЯ

┌─────────────────────────────────┬─────────────────────────────────────────┐
│ Проблема                        │ Решение                                 │
├─────────────────────────────────┼─────────────────────────────────────────┤
│ Node.js не найден               │ Создать папку node/ с node.exe          │
│ Excel не найден                 │ Добавить .xlsx файл в папку             │
│ Порт 3000 занят                 │ Изменить PORT в server.js               │
│ Нет графиков                    │ Проверить данные за 30 дней             │
│ Не обновляется                  │ F12 → проверить ошибки                  │
└─────────────────────────────────┴─────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

📊 EXCEL ТРЕБОВАНИЯ

Обязательные колонки:
• Производственный ресурс       ← Имя сотрудника
• Дата операций                  ← Дата
• Название операции              ← Операция (для логики!)
• Количество операций            ← Метрика
• Кол-во, шт                     ← Метрика
• Кол-во, уп                     ← Метрика

Важно:
✓ Названия операций в нижнем регистре (автоматически)
✓ Данные за последние 30 дней (настраивается)
✓ Первый лист Excel файла используется

═══════════════════════════════════════════════════════════════════════════════

📱 ДЛЯ ТЕЛЕВИЗОРА

1. Узнать IP компьютера:
   cmd → ipconfig → IPv4 адрес
   Пример: 192.168.1.100

2. На Smart TV открыть:
   http://192.168.1.100:3000

3. Полноэкранный режим в браузере TV

═══════════════════════════════════════════════════════════════════════════════

📚 ДОКУМЕНТАЦИЯ

┌─────────────────────────────┬───────────────────────────────────────────┐
│ Файл                        │ Когда читать                              │
├─────────────────────────────┼───────────────────────────────────────────┤
│ INDEX.md                    │ Навигация по всей документации            │
│ QUICK_START.md              │ Быстрый старт за 5 минут                  │
│ README.md                   │ Полная документация                       │
│ CONFIGURATION.md            │ Настройка параметров                      │
│ INSTALL_NODEJS.txt          │ Установка Node.js                         │
│ DEPLOYMENT_CHECKLIST.md     │ Чеклист развёртывания                     │
│ CHEATSHEET.txt              │ Этот файл (шпаргалка)                     │
└─────────────────────────────┴───────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

🌐 АДРЕСА

Локально:
• Дашборд:        http://localhost:3000
• Excel данные:   http://localhost:3000/excel

По сети:
• Дашборд:        http://[IP]:3000
• Пример:         http://192.168.1.100:3000

═══════════════════════════════════════════════════════════════════════════════

⏱️ ТАЙМИНГИ

┌─────────────────────────────┬───────────────────────────────────────────┐
│ Событие                     │ Время                                     │
├─────────────────────────────┼───────────────────────────────────────────┤
│ Автообновление дашборда     │ Каждые 60 секунд                          │
│ Первая загрузка             │ ~2 секунды                                │
│ Обновление данных           │ ~1 секунда                                │
│ Период данных (по умолч.)   │ Последние 30 дней                         │
└─────────────────────────────┴───────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

✅ КОНТРОЛЬНЫЙ СПИСОК

Перед запуском:
□ Портативный Node.js скачан
□ Папка node/ создана
□ Файл node.exe на месте
□ Excel файл добавлен
□ start.bat существует

После запуска:
□ Консоль без ошибок
□ Браузер открыт
□ Дашборд загрузился
□ Графики отображаются
□ ТОП-3 показывается

═══════════════════════════════════════════════════════════════════════════════

💡 СОВЕТЫ

• Не закрывайте консоль сервера (окно start.bat)
• Держите Excel файл закрытым при работе дашборда
• Обновление происходит автоматически - не нажимайте F5 постоянно
• Используйте тёмную тему браузера для лучшего контраста
• На телевизоре используйте полноэкранный режим

═══════════════════════════════════════════════════════════════════════════════

🎯 ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ

Q: Нужны ли права администратора?
A: Нет! Портативный Node.js работает без прав админа.

Q: Можно ли использовать с другими Excel файлами?
A: Да! Просто замените файл - дашборд найдёт его автоматически.

Q: Можно ли изменить нормативы?
A: Да! См. CONFIGURATION.md

Q: Работает ли офлайн?
A: Нужен интернет только для загрузки CDN библиотек при первом запуске.

Q: Можно ли запустить несколько дашбордов?
A: Да, но нужно изменить порт в server.js для каждого.

═══════════════════════════════════════════════════════════════════════════════

📞 ЕСЛИ НЕ РАБОТАЕТ

1. Откройте консоль браузера (F12)
2. Проверьте консоль сервера (окно start.bat)
3. Прочитайте README.md → раздел "Устранение неполадок"
4. Проверьте файлы: node/node.exe и *.xlsx должны существовать

═══════════════════════════════════════════════════════════════════════════════

                        🎉 ГОТОВО! УСПЕШНОЙ РАБОТЫ! 🎉

                    Сохраните этот файл для быстрой справки
